<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Currency Converter</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/7.0.1/css/all.min.css"
        integrity="sha512-2SwdPD6INVrV/lHTZbO2nodKhrnDdJK9/kg2XD1r9uGqPo1cUbujc+IYdlYdEErWNu69gVcYgdxlmVmzTWnetw=="
        crossorigin="anonymous" referrerpolicy="no-referrer" />
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Inter:ital,opsz,wght@0,14..32,100..900;1,14..32,100..900&family=Modak&family=MuseoModerno:ital,wght@0,100..900;1,100..900&family=Poppins:ital,wght@0,100;0,200;0,300;0,400;0,500;0,600;0,700;0,800;0,900;1,100;1,200;1,300;1,400;1,500;1,600;1,700;1,800;1,900&family=Schibsted+Grotesk:ital,wght@0,400..900;1,400..900&family=Science+Gothic:wght@100..900&display=swap');

        * {
            font-family: "Poppins", sans-serif;
            box-sizing: border-box;
            margin: 0;
            padding: 0;
            transition: .3s ease-in-out all;
        }

        body {
            background: #f2f2f9;
            display: flex;
            justify-content: center;
            align-items: center;
            text-align: center;
            height: 100vh;
            overflow: hidden;
        }

        .container {
            display: flex;
            flex-direction: column;
            text-align: center;
            justify-content: center;
            align-items: center;
            background: white;
            padding: 50px;
            height: max-content;
            width: 600px;
            gap: 10px;
            border-radius: 10px;
            box-shadow: 0px 0px 2px rgba(128, 128, 128, 0.41);
        }

        form {
            display: flex;
            padding-top: 20px;
            border-top: 2px solid rgba(128, 128, 128, 0.111);
            border-top-style: dashed;
            flex-direction: column;
            justify-content: flex-start;
            margin-top: 20px;
            width: 100%;
            align-items: flex-start;
            gap: 20px;
            text-align: left;
        }

        .dropdown {
            display: flex;
            width: 100%;
            align-items: center;
            gap: 20px;
            height: 100%;
        }

        .dropdown .from,
        .dropdown .to {
            display: flex;
            flex-direction: column;
            justify-content: flex-start;
            align-items: flex-start;
            width: 100%;
            height: 100%;
        }

        .dropdown .from div,
        .dropdown .to div {
            display: flex;
            flex-direction: column;
            justify-content: flex-start;
            align-items: flex-start;
            text-align: center;
            width: 100%;
            background: #f2f2f9;
            padding: 15px;
            border-radius: 5px;
            border: 2px solid rgba(128, 128, 128, 0.085);
        }

        img {
            overflow: hidden;
        }

        .dropdown .from div select,
        .dropdown .to div select {
            width: 100%;
            border: 1px solid orangered;
            border-style: dashed;
            padding: 5px 5px 5px 15px;
            border-radius: 5px;
        }

        select {
            appearance: none;
            /* Modern browsers */
            -webkit-appearance: none;
            /* Safari & Chrome */
            -moz-appearance: none;
            /* Firefox */
            background: none;
            border: 1px solid #ccc;
            /* optional */
            padding: 8px 12px;
            /* optional */
            outline: white;
            cursor: pointer;
        }

        .fa-arrow-right-arrow-left {
            color: orangered;
            margin-top: 20px;
        }

        .bottom_div {
            display: flex;
            flex-direction: column;
            width: 100%;
            gap: 10px;
            justify-content: center;
            align-items: center;
            text-align: center;
        }

        .bottom_div button {
            width: 100%;
            padding: 10px 20px;
            background: orangered;
            color: white;
            border: none;
            cursor: pointer;
            outline: none;
            border-radius: 5px;
        }

        .msg {
            background: #f2f2f9;
            padding: 10px;
            border-radius: 5px;
            width: 100%;
            border: 2px solid rgba(128, 128, 128, 0.066);
        }

        .amount {
            width: 100%;
            display: flex;
            flex-direction: column;
            gap: 10px;
        }

        .amount input {
            display: flex;
            width: 100%;
            border: none;
            outline: none;
            padding: 10px 20px;
            background: rgba(0, 0, 0, 0.038);
            border: 2px solid rgba(255, 68, 0, 0.097);
            border-radius: 5px;
        }
    </style>
</head>

<body>
    <div class="container">
        <h2>Currency Converter</h2>
        <form action="">
            <div class="amount">
                <P>Enter Amount</P>
                <input type="number" id="amount" value="1" min="0" step="any" placeholder="Enter amount">

                <div style="margin-top: 20px; font-size: 1.5em;"></div>
            </div>
            <div class="dropdown">
                <div class="from">
                    <p>From</p>
                    <div class="select_country" id="From_country_Selection">
                        <img id="From_country_Selection_flagImg" alt="">
                        <p id="urlfortheSelect1" style="display: none;"></p>
                        <p id="countryfortheSelect1" style="display: none;"></p>
                        <p id="FromCountry" style="display: none;"></p>
                        <select name="from" id="">
                            <option value="" selected>Select</option>
                            <option value="usd">United Sates</option>
                            <option value="pkr">Pakistan</option>
                            <option value="inr">India</option>
                            <option value="sar">Saudi Arabia</option>
                        </select>
                    </div>
                </div>
                <i class="fa-solid fa-arrow-right-arrow-left"></i>
                <div class="to">
                    <p>To</p>
                    <div class="select_country" id="to_country_Selection">
                        <img id="to_country_Selection_flagImg" alt="">
                        <p id="countryfortheSelect2" style="display: none;"></p>
                        <p id="urlfortheSelect2" style="display: none;"></p>
                        <select name="from" id="">
                            <option value="" selected>Select</option>
                            <option value="usd">United Sates</option>
                            <option value="pkr">Pakistan</option>
                            <option value="inr">India</option>
                            <option value="sar">Saudi Arabia</option>
                        </select>
                    </div>
                </div>
            </div>
        </form>
        <div class="bottom_div">
            <div class="msg" id="result"></div>
        </div>
    </div>
</body>
<script src="Country_Codes.js"></script>
<script>
    const date = new Date();
    const year = date.getFullYear();
    const month = String(date.getMonth() + 1).padStart(2, "0");
    const day = String(date.getDate()).padStart(2, "0");
    const API_DATE = `${year}-${month}-${day}`;

    const flagMap = { usd: "US", pkr: "PK", inr: "IN", sar: "SA" };

    // Elements
    const fromSelect = document.querySelector("#From_country_Selection select");
    const toSelect   = document.querySelector("#to_country_Selection select");
    const amountInput = document.getElementById("amount");
    const resultDiv   = document.getElementById("result");
    const getRateBtn  = document.getElementById("getExchangeRate");

    const fromFlag = document.getElementById("From_country_Selection_flagImg");
    const toFlag   = document.getElementById("to_country_Selection_flagImg");

    // Main conversion function
    async function convertCurrency() {
        const from = fromSelect.value.toLowerCase();
        const to   = toSelect.value.toLowerCase();
        const amount = parseFloat(amountInput.value) || 0;

        if (!from || !to || from === "" || to === "" || amount <= 0) {
            resultDiv.innerHTML = "<small>Please select currencies and enter a valid amount</small>";
            return;
        }

        const url = `https://${API_DATE}.currency-api.pages.dev/v1/currencies/${from}.json`;

        try {
            const res = await fetch(url);
            if (!res.ok) throw new Error("Rate not available today");

            const data = await res.json();
            const rate = data[from]?.[to];

            if (!rate) {
                resultDiv.innerHTML = "<small>Exchange rate not available for this pair</small>";
                return;
            }

            const convertedAmount = (amount * rate).toFixed(2);

            resultDiv.innerHTML = `
                <strong style="font-size:1.4em;">${amount.toLocaleString()} ${from.toUpperCase()} = ${parseFloat(convertedAmount).toLocaleString()} ${to.toUpperCase()}</strong><br>
                <small style="color:#555;">1 ${from.toUpperCase()} = ${rate.toFixed(6)} ${to.toUpperCase()}</small>
            `;

        } catch (err) {
            resultDiv.innerHTML = "<small style='color:red;'>Failed to fetch rates. Check internet or try again later.</small>";
            console.error(err);
        }
    }

    // Update flag image
    function updateFlag(select, imgElement) {
        const code = select.value.toLowerCase();
        const countryCode = flagMap[code] || "XX";
        imgElement.src = `https://flagsapi.com/${countryCode}/flat/64.png`;
    }

    // Event Listeners
    fromSelect.addEventListener("change", () => {
        updateFlag(fromSelect, fromFlag);
        convertCurrency();
    });

    toSelect.addEventListener("change", () => {
        updateFlag(toSelect, toFlag);
        convertCurrency();
    });

    amountInput.addEventListener("input", convertCurrency);
    getRateBtn.addEventListener("click", convertCurrency);

    // Initialize on page load
    document.addEventListener("DOMContentLoaded", () => {
        // Set default flags
        updateFlag(fromSelect, fromFlag);
        updateFlag(toSelect, toFlag);
        // Auto-convert on load (with default amount = 1)
        convertCurrency();
    });
</script>

</html>
